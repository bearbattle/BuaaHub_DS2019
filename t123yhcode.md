# t123yh’s Decode

>密码学是关于如何在敌人存在的环境中通信。——罗纳德·李维斯特, 密码学者

## 题目描述

在信息传递的过程中，我们常常需要使用加密手段来确保传递信息的安全性，特别是涉及个人隐私的内容，例如在通信软件中传递的消息。我们使用各种各样的加密手段来确保信息传递过程中的秘密性。

*t123yh* 是一名程序员，最近他写了一个聊天软件 *HubChat* 。在选择消息对消息加密方法的过程中，*t123yh* 想到了一种混合的密码算法。

密码学中，需要加密的信息被称作明文，用$I$表示，加密后的信息被称作为密文，用$O$表示，加密过程中使用的密钥记作$key$，我们利用密钥$key$对明文$I$进行某种操作，使其变为密文$O$，这个过程称作**加密**。

相应的，我们利用密钥$key$对密文$O$进行某种操作，使其变为明文$I$，这个过程称作**解密**。

在 t123yh 的加密算法中，我们使用如下方法构造密码：

对于密钥$K=k_1k_2k_3...k_m$，  
当明文 $O=o_1o_2o_3...o_n$ 时，  
得到密文$E=e_1e_2e_3...e_n$，  
其中$e_j=f(o_j, k_j)$

映射$z=f(x,y)$的规则如下：

![函数f](https://i.loli.net/2019/04/19/5cb9919d5745b.png)  

注意：  
1.这个映射**保持明文和密文字母的大小写**，简单来说：

* 当$o_j​$是大写时，$e_j​$也是大写；  
* 当$o_j​$是小写时，$e_j​$也是小写；  

*这要求你在进行加密时判断被加密的字符大小写*  
2.当明文$I​$的长度大于密钥 $key​$ 的长度时，将密钥$key​$**重复使用**。为了确保安全性，每次用完一遍密钥之后，密钥就会发生改变，将每一位后移，并将最后一位放在第一个的位置。  
举例来说，"abcd"这个密钥被使用一轮之后（这里的一轮定义为$f(O_i,K_i)$中的$K_i$分别取过'a','b','c','d'），就会变成"dabc"，进行下一轮的加密。

*t123yh* 叉了会腰之后，突然觉得这个算法应该更牛逼一点，比如通过同一个过程就可以完成加密和解密，于是他又构造了一个被称作“反射器”的机制。反射器可以把两个字母连接在一起，每当一个字母通过反射器的时候就会被转换成对应的字母。如果用函数 $g(x)$ 来表示反射器，那么它将有如下性质：若 $g(m)=n$ ，则有$g(n)=m$，并且保证 $m \not = n$。*t123yh*决定取$g(x)$的映射表如下：  
|$x$|$g(x)$|
|-|-|  
|A|B|
|B|A|
|C|D|
|D|C|
|E|F|
|F|E|
|G|H|
|H|G|
|I|J|
|J|I|
|K|L|
|L|K|
|M|N|
|N|M|
|O|P|
|P|O|
|Q|R|
|R|Q|
|S|T|
|T|S|
|U|V|
|V|U|
|W|X|
|X|W|
|Y|Z|
|Z|Y|

于是我们可以进一步构造这样一种加密规则：  
1.*将明文通过原来的算法“加密”*  
2.*然后将获得的字符输入反射器*  
3.*再将反射器输出的字符用同一位密钥“解密”，得到最终的密文。*  

显然，如果使用同样的密钥，用相同的顺序操作密文也可以获得其明文。

用公式表示则是：  
$E_i=f^{-1}(g(f(O_i,K_i)),K_i)$  
其中

* $E_i$ ：密文第$i$个字符  
* $O_i$ ：明文第$i$个字符  
* $K_i$ ：密钥第$i$个字符  

由于网络问题，待解密的密文串并不是按照时间顺序排列的，但是，好在*t123yh*在每条消息的前面加上了格式为*YYYY-MM-DD-HH-MM-SS*的时间戳。你可以借助这个时间戳在解密之后对明文进行排序，并按照时间顺序输出。

## 输入输出格式

### 输入格式

多行输入数据。

第 1 行：一个数字 $n$ ，代表接下来有 $n$ 条被加密的信息。

第 2 行：一个字符串，表示密钥 $key$，长度不超过 **100**，其中**仅包含大小写字母**。

第 3 行起的$n$行：消息字符串，其包括形如*YYYY-MM-DD-HH-MM-SS*和一串表示经加密后的**密文$O$**字符串，每行长度不超过 **1000** 字符，其中**密文仅包含大小写字母**，二者中间以空格分隔。

### 输出格式

$n$行字符串，按照时间顺序输出**时间戳**和**字符串**表示输入密钥和密文所对应的明文，每行中间以一个空格分隔。

## 样例数据

### 样例输入

```txt
4
CompleteVictory
2019-04-20-20-10-00 QfduEplszi
2019-04-19-05-13-59 szgOC
2019-04-20-20-15-26 efmfojhvlbmejqbpmpofnhmrgbmf
2019-04-18-15-30-44 gfkmnxnqmc
```

### 样例输出

```txt
2019-04-19-05-13-59 aqweruy
2019-04-20-20-10-00 asdfhjgjhvbj
2019-04-20-20-15-26 AqweruiyoYIE
```
